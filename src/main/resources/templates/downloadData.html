<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <meta charset="utf-8"/>
    <title>数据导出</title>
    <!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <!--<link rel="stylesheet" th:href="@{/css/bootstrap.min.css}"/>-->
    <link rel="stylesheet" th:href="@{/css/registration.css}"/>
    <!-- 引用jquery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!--<script th:src="@{/js/jquery.min.js}" type="text/javascript"></script>-->
    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>
    <!--<script th:src="@{/js/bootstrap.min.js}" type="text/javascript"></script>-->
    <!-- 引入bootstrap 时间组件 -->
    <link rel="stylesheet" media="screen" th:href="@{/css/bootstrap-datetimepicker.min.css}"/>
    <script th:src="@{/js/bootstrap-datetimepicker.min.js}" type="text/javascript"></script>
    <script type="text/javascript" th:src="@{/js/bootstrap-datetimepicker.zh-CN.js}"></script>
</head>
<body>
<div class="mainContainer">
    <form onsubmit="return checkDownloadData()" th:action="@{/admin/downloadData}" method="post">
        <div class="form-group">
            <div class="text-center">
                <h2>数据导出</h2>
            </div>
        </div>
        <div class="row">
            <div class="form-group col-sm-offset-3 col-sm-6">
                <label for="startTime" class="control-label">开始时间：</label>
                <div class="input-group date form_datetime "
                     data-date-format="yyyy年MMdd日" data-link-field="startTime">
                    <input class="form-control" size="16" type="text" value="" placeholder="请选择开始时间" readonly>
                    <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
                    <span class="input-group-addon"><span class="glyphicon glyphicon-th"></span></span>
                </div>
                <input type="hidden" id="startTime" readonly required/><br/>
            </div>
        </div>
        <input hidden="hidden" name="startTime" id="startTimeValue"/>
        <input hidden="hidden" name="endTime" id="endTimeValue"/>
        <div class="row">
            <div class="form-group col-sm-offset-3 col-sm-6">
                <label for="endTime" class="control-label">结束时间：</label>
                <div class="input-group date form_datetime "
                     data-date-format="yyyy年MMdd日" data-link-field="endTime">
                    <input class="form-control" size="16" type="text" value="" placeholder="请选择结束时间" readonly>
                    <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
                    <span class="input-group-addon"><span class="glyphicon glyphicon-th"></span></span>
                </div>
                <input type="hidden" id="endTime" readonly required/><br/>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-offset-3 col-sm-2">
                <button type="reset" class="btn btn-lg btn-danger btn-block">全部清空</button>
            </div>
            <div class="col-sm-offset-2 col-sm-2">
                <button type="submit" id="check-btn"
                        class="btn btn-lg btn-success btn-block">
                    导出数据
                </button>
            </div>
        </div>
    </form>
</div>
</body>
<script th:src="@{/js/httpRequest.js}" type="text/javascript"></script>
</html>
<script type="text/javascript">
    <!-- 时间组件初始化 -->
    $('.form_datetime').datetimepicker({
        weekStart: 0, //一周从哪一天开始
        todayBtn: 1, //
        minView: "month", // 不显示时分秒
        autoclose: 1,
        language: 'zh-CN',
        todayHighlight: 1,
        startView: 2,
        forceParse: 0,
        showMeridian: 1,
        minuteStep: 1
    });
    var checkDownloadData = function () {
        var startTime = $("#startTime");
        if (startTime.val() === "") {
            alert("请填写开始时间！");
            return false;
        }
        // 将时间转换长时间戳
        var dateTime = new Date(startTime.val()).getTime();
        var startTimeValue = $("#startTimeValue");
        startTimeValue.attr("value", dateTime);
        var endTime = $("#endTime");
        if (endTime.val() === "") {
            alert("请填写开始时间！");
            return false;
        }
        // 将时间转换长时间戳
        dateTime = new Date(endTime.val()).getTime();
        var endTimeValue = $("#endTimeValue");
        endTimeValue.attr("value", dateTime);
        if (startTimeValue.val() >= endTimeValue.val()) {
            alert("结束时间不能比开始时间早！请重新填写！");
            return false;
        }
        return true;
    };
</script>